<!DOCTYPE html>
<!-- saved from url=(0127)https://docs.google.com/document/d/e/2PACX-1vS5i1qnkrtcsv8rBbrs6AbgDG9QOMXAgrDgj01n3rqDtOaAVqcx9xxa12gNiNOQ1ud7YDb9m-7pdui2/pub -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>WebPerfWG - March 17 2022</title><link rel="shortcut icon" href="https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico"><meta name="referrer" content="strict-origin-when-cross-origin"><style type="text/css" nonce="">
      @import url("https://fonts.googleapis.com/css?family=Google+Sans");
      @import url("https://fonts.googleapis.com/css?family=Roboto");

      body {
        font-family: Roboto, arial, sans, sans-serif;
        margin: 0;
      }

      iframe {
        border: 0;
        frameborder: 0;
        height: 100%;
        width: 100%;
      }

      #banners {
        align-items: center;
        background: white;
        display: block;
        justify-content: space-between;
        position: fixed;
        top: 0;
        width: 100%;
        z-index: 100;
      }

      #banners #publish-banner {
        background-color: #e8f0fe;
        border-bottom: 1px #ccc solid;
        color: #202124;
        display: flex;
        flex: 1 1 0%;
        height: 60px;
        width: 100%;
      }

      #publish-banner-icon {
        display: flex;
        fill: #1967d2;
        margin: auto 20px;
      }

      #publish-banner-text {
        flex-grow: 1;
        margin: auto 0;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      #publish-banner-buttons {
        margin: auto 25px auto 0;
      }

      #publish-banner-buttons span {
        align-self: center;
        background-color: inherit;
        border: none;
        font-family: "Google Sans", Roboto, RobotoDraft, Helvetica, Arial, sans-serif;
        margin: 0 16px 0 32px;
      }

      #publish-banner-buttons a {
        color: #1967d2;
        cursor: pointer;
        font-family: "Google Sans", Roboto, RobotoDraft, Helvetica, Arial, sans-serif;
        font-size: 14px;
        font-weight: 500;
        line-height: 24px;
        text-decoration: none;
      }

      #banners #title-banner {
        background: white;
        border-bottom: 1px #ccc solid;
        display: flex;
        flex: 1 1 0%;
        height: 60px;
        width: 100%;
      }

      #banners #title-banner #title {
        flex-grow: 1;
        font-family: 'Google Sans';
        font-size: large;
        margin: auto 0 auto 20px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        width: 70%;
      }

      #banners #title-banner #interval {
        margin: auto 25px auto 0;
        font-family: Roboto;
        font-size: small;;
      }

      #footer {
        background: #f0f0f0;
        border-bottom: 1px #ccc solid;
        bottom: 0;
        font-family: Roboto;
        font-size: small;
        padding: 10px 10px;
        position: fixed;
        text-align: center;
        width: 100%;
      }

      #contents {
        padding: 50px 5% 50px 5%;
      }

      @media only screen and (max-device-width: 800px) {
        #banners #title-banner {
          border-bottom-width: 5px;
          height: auto;
          display: block;
        }

        #banners #title-banner #title {
          font-size: 3em;
          margin: auto 0 auto 20px;
          width: 90%;
        }

        #banners #title-banner #interval {
          font-size: 1.5em;
          margin: 10px 0 auto 25px;
        }

        #contents {
          padding: 150px 5% 80px;
        }

        #footer {
          font-size: 2em;
        }
      }

      .dash {
        padding: 0 6px;
      }
    </style></head><body><div id="banners"><div style="display:none" id="publish-banner"><span id="publish-banner-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"></path></svg></span><div id="publish-banner-text">Published using Google Docs</div><div id="publish-banner-buttons"><span><a target="_blank" title="Learn more" href="https://support.google.com/docs/answer/183965">Learn More</a></span><span><a href="https://docs.google.com/u/0/abuse?id=AKkXjozWtMh954xrYu9HcD_RwhSsVoFnKGEPyc7P5_k6tlSO4pT4kAfaMo6zt287Zk_PrT6tpxFi3fuvp1-9F88:0"></a></span></div></div><div id="title-banner"><div id="title">WebPerfWG - March 17 2022</div><div id="interval"><span></span></div></div></div><div id="contents"><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=OPeqXG-QxW3ZD8BtmPikfA');.lst-kix_nw306mkeg9fj-0>li:before{content:"\0025cf  "}ul.lst-kix_koe6dwidkt75-7{list-style-type:none}ul.lst-kix_koe6dwidkt75-8{list-style-type:none}.lst-kix_nw306mkeg9fj-3>li:before{content:"\0025cf  "}.lst-kix_nw306mkeg9fj-4>li:before{content:"\0025cb  "}.lst-kix_nw306mkeg9fj-5>li:before{content:"\0025a0  "}.lst-kix_nw306mkeg9fj-7>li:before{content:"\0025cb  "}.lst-kix_nw306mkeg9fj-6>li:before{content:"\0025cf  "}.lst-kix_nw306mkeg9fj-8>li:before{content:"\0025a0  "}ul.lst-kix_koe6dwidkt75-3{list-style-type:none}ul.lst-kix_koe6dwidkt75-4{list-style-type:none}ul.lst-kix_koe6dwidkt75-5{list-style-type:none}ul.lst-kix_koe6dwidkt75-6{list-style-type:none}.lst-kix_koe6dwidkt75-5>li:before{content:"\0025a0  "}ul.lst-kix_koe6dwidkt75-0{list-style-type:none}ul.lst-kix_koe6dwidkt75-1{list-style-type:none}.lst-kix_koe6dwidkt75-4>li:before{content:"\0025cb  "}ul.lst-kix_koe6dwidkt75-2{list-style-type:none}.lst-kix_koe6dwidkt75-3>li:before{content:"\0025cf  "}.lst-kix_koe6dwidkt75-2>li:before{content:"\0025a0  "}.lst-kix_koe6dwidkt75-6>li:before{content:"\0025cf  "}.lst-kix_koe6dwidkt75-7>li:before{content:"\0025cb  "}ul.lst-kix_nw306mkeg9fj-1{list-style-type:none}ul.lst-kix_nw306mkeg9fj-0{list-style-type:none}ul.lst-kix_nw306mkeg9fj-3{list-style-type:none}ul.lst-kix_nw306mkeg9fj-2{list-style-type:none}.lst-kix_koe6dwidkt75-1>li:before{content:"\0025cb  "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_koe6dwidkt75-0>li:before{content:"\0025cf  "}.lst-kix_koe6dwidkt75-8>li:before{content:"\0025a0  "}ul.lst-kix_nw306mkeg9fj-8{list-style-type:none}ul.lst-kix_nw306mkeg9fj-5{list-style-type:none}ul.lst-kix_nw306mkeg9fj-4{list-style-type:none}ul.lst-kix_nw306mkeg9fj-7{list-style-type:none}ul.lst-kix_nw306mkeg9fj-6{list-style-type:none}.lst-kix_nw306mkeg9fj-2>li:before{content:"\0025a0  "}.lst-kix_nw306mkeg9fj-1>li:before{content:"\0025cb  "}ol{margin:0;padding:0}table td,table th{padding:0}.c1{margin-left:36pt;padding-top:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c3{-webkit-text-decoration-skip:none;color:#3367d6;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:10pt;font-family:"Roboto"}.c15{padding-top:20pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c0{color:#202124;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Roboto";font-style:normal}.c6{background-color:#ffffff;padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c16{padding-top:18pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c4{background-color:#ffffff;padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c10{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c8{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:20pt;font-family:"Arial";font-style:normal}.c5{color:#5f6368;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Roboto";font-style:normal}.c12{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c17{color:#000000;font-weight:400;text-decoration:none;font-size:16pt;font-family:"Arial"}.c7{font-size:10pt;font-family:"Roboto";color:#202124;font-weight:400}.c18{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c19{background-color:#ffffff;max-width:600pt;}.c9{color:inherit;text-decoration:inherit}.c11{vertical-align:baseline;font-style:normal}.c14{margin-left:72pt;padding-left:0pt}.c13{padding:0;margin:0}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style><div class="c19"><h1 class="c15" id="h.dlwz2w56rutg"><span class="c8">Participants</span></h1><p class="c12"><span class="c2">Alex N. Jose, Pat Meenan, Andrew Galloni, Nic Jansma, Alex Christensen, Sean Feng, Ian Clelland, Marcel Duran, John Engebretson, Giacomo Zechini, Nitish Mittai, Ankit Jain, Alon Kochba, Hardien Raffali, Michal Mocny, Philip Walton, Noam Helfman, Yoav Weiss, Neil Craig, Tim Kadlec, Carine Bournez, Philip Tellis, Xiaochen Hu</span></p><h1 class="c15" id="h.fy0oob9tymmx"><span class="c8">Minutes</span></h1><h2 class="c16" id="h.xqd0doo0cehy"><span class="c18"><a class="c9" href="https://www.google.com/url?q=https://docs.google.com/presentation/d/1-cxHITwVtWJ5x3ev0__XzDtDtJn2cB9CAgN9Mkia3Ag/edit%23slide%3Did.g11de5b0bf6b_0_304&amp;sa=D&amp;source=editors&amp;ust=1647622731262046&amp;usg=AOvVaw1ENOhe8pJA2SSdzN5lnkF0">A/B testing</a></span><span class="c11 c17">&nbsp;- Alex N. Jose</span></h2><p class="c12"><span class="c18"><a class="c9" href="https://www.google.com/url?q=https://youtu.be/oBl5JLjadYM&amp;sa=D&amp;source=editors&amp;ust=1647622731262615&amp;usg=AOvVaw2tN8DvR5HAuXb1OoRR2HEX">Presentation recording</a></span></p><ul class="c13 lst-kix_nw306mkeg9fj-0 start"><li class="c1 li-bullet-0"><span class="c2"><b>Alex</b><b></b>: Discussions last year about this</span></li><li class="c1 li-bullet-0"><span class="c2">A/B testing is about applying changes to a web application on the browser - typically cosmetic changes</span></li><li class="c1 li-bullet-0"><span class="c2">Using JS to perform those changes which often results in a performance cost - scripts is fetched, parsed and executed and if done in a blocking way that incurs a penalty in FP/FCP</span></li><li class="c1 li-bullet-0"><span class="c2">If we‚Äôre not blocking, the result is a flash on pre-modification document</span></li><li class="c1 li-bullet-0"><span class="c2">It‚Äôs a flexible solution that enables non-technical folks to run experiments and is very popular</span></li><li class="c1 li-bullet-0"><span class="c2">Even for teams that do server-side A/B testing, client-side enables them to offload some cosmetic efforts</span></li><li class="c1 li-bullet-0"><span class="c2">Discussed last year. Basically we want the outcomes of A/B testing without the performance penalties</span></li><li class="c1 li-bullet-0"><span class="c2">Had ideas around standardizing a transformation language, using edge as the insertion point or to block just rendering in the browser without parser blocking</span></li><li class="c1 li-bullet-0"><span class="c2">Took some of those ideas and explored how that would function, resulting in a spec sketch and a prototype. Hoping to get feedback on that.</span></li><li class="c1 li-bullet-0"><span class="c2">Conceptually, A/B testing is composed of a control document and a set of transformations, expected to be idempotent, so if you apply them multiple times, there are no side effects. E.g. if you have a list of items and the user goes back to a page, the items won‚Äôt be duplicated. </span></li><li class="c1 li-bullet-0"><span class="c2">We don‚Äôt define in the spec how these transformations are idempotent, only that they should be</span></li><li class="c1 li-bullet-0"><span class="c2">We broadly classify the transformation to be of 2 types: pre_ua and on_ua</span></li><li class="c1 li-bullet-0"><span class="c2">The pre_ua are equivalent to a server-side transforms</span></li><li class="c1 li-bullet-0"><span class="c2">On_ua ones are ones that require client-side JS - e.g. for SPAs</span></li><li class="c1 li-bullet-0"><span class="c2">Want to apply both without performance degradations</span></li><li class="c1 li-bullet-0"><span class="c2">What would a transform look like? </span></li><li class="c1 li-bullet-0"><span style="overflow: hidden;<b> display</b><b></b>: inline-block;<b> margin</b><b></b>: 0.00px 0.00px;<b> border</b><b></b>: 0.00px solid #000000;<b> transform</b><b></b>: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);<b> width</b><b></b>: 525.00px;<b> height</b><b></b>: 255.00px;"><img alt="" src="./WebPerfWG - March 17 2022_files/Screen Shot 2022-03-17 at 18.13.45.png" style="width: 525.00px;<b> height</b><b></b>: 255.00px; margin-left: 0.00px; margin-top: 0.00px;<b> transform</b><b></b>: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li><li class="c1 li-bullet-0"><span style="overflow: hidden;<b> display</b><b></b>: inline-block;<b> margin</b><b></b>: 0.00px 0.00px;<b> border</b><b></b>: 0.00px solid #000000;<b> transform</b><b></b>: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);<b> width</b><b></b>: 507.00px;<b> height</b><b></b>: 253.00px;"><img alt="" src="./WebPerfWG - March 17 2022_files/Screen Shot 2022-03-17 at 18.14.21.png" style="width: 507.00px;<b> height</b><b></b>: 253.00px; margin-left: 0.00px; margin-top: 0.00px;<b> transform</b><b></b>: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li><li class="c1 li-bullet-0"><span class="c2">Examples include color changes, title changes, different text, coloring the first item in a list, etc</span></li><li class="c1 li-bullet-0"><span class="c2">Sequence diagram of a prototype through a CloudFlare worker</span></li><li class="c1 li-bullet-0"><span style="overflow: hidden;<b> display</b><b></b>: inline-block;<b> margin</b><b></b>: 0.00px 0.00px;<b> border</b><b></b>: 0.00px solid #000000;<b> transform</b><b></b>: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);<b> width</b><b></b>: 381.00px;<b> height</b><b></b>: 326.00px;"><img alt="" src="./WebPerfWG - March 17 2022_files/Screen Shot 2022-03-17 at 18.15.39.png" style="width: 381.00px;<b> height</b><b></b>: 326.00px; margin-left: 0.00px; margin-top: 0.00px;<b> transform</b><b></b>: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li><li class="c1 li-bullet-0"><span class="c2">For the prototype I‚Äôm using a git based mechanism, not a real A/B provider</span></li><li class="c1 li-bullet-0"><span class="c2">Code + on_ua transforms are injected to the head of the document</span></li><li class="c1 li-bullet-0"><span style="overflow: hidden;<b> display</b><b></b>: inline-block;<b> margin</b><b></b>: 0.00px 0.00px;<b> border</b><b></b>: 0.00px solid #000000;<b> transform</b><b></b>: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);<b> width</b><b></b>: 494.00px;<b> height</b><b></b>: 200.00px;"><img alt="" src="./WebPerfWG - March 17 2022_files/Screen Shot 2022-03-17 at 18.17.22.png" style="width: 494.00px;<b> height</b><b></b>: 200.00px; margin-left: 0.00px; margin-top: 0.00px;<b> transform</b><b></b>: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li><li class="c1 li-bullet-0"><span class="c2">The prototype is using a mutation observer that listens to all the DOM changes, and that‚Äôs the only blocking work</span></li><li class="c1 li-bullet-0"><span class="c2">The rest of the work happens async, as the browser parses the document and when JS is making changes to the DOM. Each matching element gets processed through the transform functions.</span></li><li class="c1 li-bullet-0"><span class="c2">Transform functions are current generic JS, want to open that for debate</span></li><li class="c1 li-bullet-0"><span style="overflow: hidden;<b> display</b><b></b>: inline-block;<b> margin</b><b></b>: 0.00px 0.00px;<b> border</b><b></b>: 0.00px solid #000000;<b> transform</b><b></b>: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);<b> width</b><b></b>: 549.00px;<b> height</b><b></b>: 261.00px;"><img alt="" src="./WebPerfWG - March 17 2022_files/Screen Shot 2022-03-17 at 18.19.00.png" style="width: 549.00px;<b> height</b><b></b>: 261.00px; margin-left: 0.00px; margin-top: 0.00px;<b> transform</b><b></b>: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li><li class="c1 li-bullet-0"><span class="c2">Demo is using Cloudflare workers with Low Latency HTML parser and using a GH gist as the JSON source.</span></li><li class="c1 li-bullet-0"><span class="c2">Used React MVC for the demo.</span></li><li class="c1 li-bullet-0"><span class="c2">Title is created in JS along with the rest of the app. Want to change it as it‚Äôs created.</span></li><li class="c1 li-bullet-0"><span class="c2">Control json</span></li><li class="c1 li-bullet-0"><span style="overflow: hidden;<b> display</b><b></b>: inline-block;<b> margin</b><b></b>: 0.00px 0.00px;<b> border</b><b></b>: 0.00px solid #000000;<b> transform</b><b></b>: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);<b> width</b><b></b>: 624.00px;<b> height</b><b></b>: 430.67px;"><img alt="" src="./WebPerfWG - March 17 2022_files/Screen Shot 2022-03-17 at 18.20.43.png" style="width: 624.00px;<b> height</b><b></b>: 430.67px; margin-left: 0.00px; margin-top: 0.00px;<b> transform</b><b></b>: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li><li class="c1 li-bullet-0"><span class="c2">Includes the 2 variants</span></li><li class="c1 li-bullet-0"><span class="c2">The transformation itself is JS</span></li><li class="c1 li-bullet-0"><span class="c2">Could create issues because the language for on_ua and pre_ua is not the same, and edge may not run arbitrary JS</span></li><li class="c1 li-bullet-0"><span class="c2">We have an ongoing test, so that as the list gets added more items, the styles get re-applied to what‚Äôs now the first - done for demo purposes</span></li><li class="c1 li-bullet-0"><span class="c2">*demos that page is switching between variant A and B*</span></li><li class="c1 li-bullet-0"><span class="c2">No flash of pre-variant content, and variations are applied on an ongoing basis as items are added to the list</span></li><li class="c1 li-bullet-0"><span class="c2">From a perf characteristics, there‚Äôs no visible cost to running the experiment</span></li><li class="c1 li-bullet-0"><span class="c2">In repeated tests, it doesn‚Äôt show significant perf costs</span></li><li class="c1 li-bullet-0"><span class="c2">Key lessons - The edge/CDN based approach enables parallel A/B configuration fetch</span></li><li class="c1 li-bullet-0"><span class="c2">Having the transformations before document creation is key to performance - head injection</span></li><li class="c1 li-bullet-0"><span class="c2">CDNs may not be excited about arbitrary JS</span></li><li class="c1 li-bullet-0"><span class="c2">Where do we go from here?</span></li><li class="c1 li-bullet-0"><span class="c2">Could standardize the transforms and move away from JS, even though that‚Äôs different from what A/B testers are doing today.</span></li></ul><ul class="c13 lst-kix_nw306mkeg9fj-1 start"><li class="c12 c14 li-bullet-0"><span class="c2">Could use mutation records</span></li><li class="c12 c14 li-bullet-0"><span class="c2">They would be more verbose - could avoid some problems by moving the implementation of the ‚Äúapplicator‚Äù into the browser</span></li></ul><ul class="c13 lst-kix_nw306mkeg9fj-0"><li class="c1 li-bullet-0"><span class="c2">Could move the ‚Äúedge‚Äù part to the origin - doesn‚Äôt have to be a CDN, which may an architectural change</span></li><li class="c1 li-bullet-0"><span class="c2">If we move this to the browser, there would be a cost, because the browser can only fetch the config after seeing the document, rather than in parallel</span></li><li class="c1 li-bullet-0"><span class="c2">Spec in progress - ‚Äúblocking=render‚Äù implementation, that could enable us to do the same thing without the edge, would block rendering without blocking parsing</span></li></ul><ul class="c13 lst-kix_nw306mkeg9fj-1 start"><li class="c12 c14 li-bullet-0"><span class="c2">Could be a significant benefit for current A/B testing</span></li></ul><ul class="c13 lst-kix_nw306mkeg9fj-0"><li class="c1 li-bullet-0"><span class="c2">Interested in opinions on how we can take it from here</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Michal</b><b></b>: Small question. In the TODO MVC example, removing item 1 made item 2 become red only after a while, because MutationObservers take time. Is that inherent to the prototype or is this how client side A/B testing works?<br><b>Alex</b><b></b>: I haven‚Äôt seen the flash. The mutations are deferred to the next animation frame, so maybe there‚Äôs a one frame lag. Should look at that in detail. In my testing I haven‚Äôt seen such flashes</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Michal</b><b></b>: There‚Äôs how long it takes for mutation observers to be applied</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Alex</b><b></b>: Hoping to find out how complex transformations can be</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Pat</b><b></b>: When prototyping were there browser capabilities you found were missing? Are mutationObservers good enough? Needed to polyfill something?</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Alex</b><b></b>: Capability to install a SW as part of the first request could have avoided the need for the Edge here. But there are some challenges with that</span></li><li class="c1 li-bullet-0"><span class="c2">‚Ä¶ For mutation observers specifically, that part is working great, but need to test that with complex pages</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Pat</b><b></b>: Didn‚Äôt run into any transforms that you couldn‚Äôt do?</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Alex</b><b></b>: No because I allowed transformations to be arbitrary JS. If we move away from JS, then the capabilities may be limited, and then we could run into problems when doing complex things.</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Nitish</b><b></b>: Represent A/B testing provider. Can tell that using MutationObservers on a complex page, we‚Äôve seen deadlocks created - the application trying to create components and the scripts tries to create changes, where the 2 parties try both to apply changes. Seen this as a practical limitation. Would definitely need a way to avoid conflicts when 2 parties try to apply changes to the same element.</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Alex</b><b></b>: Is that because we‚Äôre applying changes sync? One of the things I‚Äôve done is to defer all the required changes to the next paint cycle. But I can see the problem you mention if the application depends on DOM state</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Nitish</b><b></b>: Seen changes get delayed, even if they are applied in the next cycle. There‚Äôs a chance of users seeing portions of the control page. </span></li><li class="c1 li-bullet-0"><span class="c2"><b>Alex</b><b></b>: We could use a different construct in the browser that helps to give priority to these mutations.</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Nitish</b><b></b>: When applying mutationObserver on the body, the number of mutations is huge and they happen very frequently. If every mutation would apply a DOM change, that could be very expensive in terms of computation</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Alex</b><b></b>: The performance will depend on the transform code, and selector performance. Prototype defers transforms until the next paint cycle, to reduce computation and acting on each MutationRecord.</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Pat</b><b></b>: That‚Äôs what I was getting to - need a mutation observer with the selectors built in. That lets React to let you hook into the VDOM rather than the real DOM</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Alex</b><b></b>: Standardization could help on that front. Having the transformations applied by the browser</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Nitish</b><b></b>: If the operations are applied again and again, their results should be the same. If I add items to a list, the end output needs to remain the same regardless of how many times the function was applied</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Alex</b><b></b>: Yeah, that‚Äôs one of the requirements. The spec is expecting that you check the conditions to make these transforms idempotent. One can shoot themselves in the foot if, say, a navigation item was added multiple times as the user is navigating back and forth between pages in an SPA. Transform has to ensure that they are idempotent. in</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Nitish</b><b></b>: If you‚Äôre applying the changes to a DOM attribute. It might re-render itself entirely or partially.</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Alex</b><b></b>: Should have an example of that. Could check if we‚Äôre really applying the transformation. You can have conditional checks as part of the transformations. The expectation is that the A/B transform is created in a way that‚Äôs idempotent.</span></li><li class="c1 li-bullet-0"><span class="c2">That‚Äôs harder in the version where we have dedicated transformation language</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Hadrien</b><b></b>: PM for Google Optimize. Excited about this. Probably our biggest problem</span></li><li class="c1 li-bullet-0"><span class="c2">‚Ä¶ would it be helpful if we sent you examples of pages that customers complain about performance? What would help stress-test this? Especially over mobile</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Alex</b><b></b>: That‚Äôd be awesome. I chose to test this over 3G/Mumbai. But more complex pages would be great</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Michal</b><b></b>: Is there a tool that creates these configs?</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Hadrien</b><b></b>: Google Optimize product has a wysiwyg editor. Sophisticated customers would write code inside the editor, but most don‚Äôt</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Michal</b><b></b>: Can we create an experiment where this transforms are the output</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Hadrien</b><b></b>: probably</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Alex</b><b></b>: Optimize currently transforms everything to JS, right?</span></li><li class="c1 li-bullet-0"><span class="c2">‚Ä¶ How much JS do we need? Would a finite operation set be sufficient?</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Hadrien</b><b></b>: Not sure what the limitations would be for a more restricted set. Can you walk through both cases?</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Alex</b><b></b>: on_ua you have a fully capable JS, but if you wanted to define it as a set of DOM operations, these operations limit your capability. E.g. click adds something to cart, which modified the JS state, not a DOM operation. It‚Äôs theoretically possible, but not sure if that‚Äôs something someone is doing</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Hadrien</b><b></b>: We would go for more capabilities. I imagine it comes at a cost. Customers do a wide range of things. Instinctively, arbitrary JS.</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Pat</b><b></b>: Wondering if we‚Äôre trying to standardize the entire package, or are there atomic pieces that we should standardize and not try to specify the client-side transformations themselves? i.e. A spec for edge HTML rewrites that all CDN‚Äôs (and servers) could implement that would allow for fetching of the experiment definition, group selection and HTML transforms (one of which would be embedding any client-side JS and transform definitions that need to be written but that should be provider-specific). Are there browser-side API‚Äôs that need to be improved to make the client-side transforms more efficient?</span></li><li class="c1 li-bullet-0"><span class="c2">‚Ä¶ How do we standardize the HTML rewriting on the Edge feels important.</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Hadrien</b><b></b>: Our customers are moving to server-side experiments which are much more costly</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Neil</b><b></b>: Work at the BBC. Going through a process of site-wide A/B testing. What Pat just said - we‚Äôre really struggling because we have to do everything on the server side, which explodes the cache.</span></li><li class="c1 li-bullet-0"><span class="c2">‚Ä¶ Mandating edge service - would be great for us to be able to do everything client side without any edge servers</span></li><li class="c1 li-bullet-0"><span class="c2">‚Ä¶ otherwise, can the A/B policy be cached client side?</span></li><li class="c1 li-bullet-0"><span class="c2">‚Ä¶ Struggle around making experiments sticky, where users switch groups. Ensuring that the A/B group is sticky would be great.</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Nitish</b><b></b>: Thoughts on standardization. Full JS power gives you a ton of flexibility - hybrid approach would be great, enabling custom JS for some things, but standard operations for most things.</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Andrew</b><b></b>: Thoughts - why would you need differences between pre_ua and on_ua? Any edge hop in between can perform transformations based on capabilities</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Alex</b><b></b>: A/B provider is best to make that judgement, some have to be applied on the client e.g. for an SPA. Some DOM elements are only created on the client.</span></li><li class="c1 li-bullet-0"><span class="c2">Another example is swapping a stylesheet - needs to be done on the server before the client fetched the control stylesheet</span></li><li class="c1 li-bullet-0"><span class="c2">An instance where we need both ON_UA and PRE_UA on the same transform is a server side rendered SPA, where markup will be present during PRE_UA, that needs to be transformed, and later ON_UA, where it would be potentially re-rendered. Thus transforms at both places are needed. </span></li><li class="c1 li-bullet-0"><span class="c2">‚Ä¶ But I like the direction we‚Äôre suggesting to take a hybrid approach. Have a defined spec that can be applied in a performant way by the Edge/UA, and also having the spec allowing JS</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Andrew</b><b></b>: Any API you want on the Edge that‚Äôd make this easier?</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Alex</b><b></b>: Asking an Edge impl from someone that doesn‚Äôt have one requiring arch change. Browser changes could enable avoiding edge mandats - moving the edge to the client</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Nic</b><b></b>: best forum?</span></li><li class="c1 li-bullet-0"><span class="c2"><b>Yoav</b><b></b>: WICG repo, probably</span></li></ul><p class="c10"><span class="c2"></span></p><p class="c10"><span class="c2"></span></p><h1 class="c15" id="h.8enigjajkb15"><span class="c8">Chat Log</span></h1><p class="c6"><span class="c7">You</span><span class="c5">1:03 PM</span></p><p class="c4"><span class="c3"><a class="c9" href="https://www.google.com/url?q=https://forms.gle/QDUYYAQBrhh1q13A8&amp;sa=D&amp;source=editors&amp;ust=1647622731274263&amp;usg=AOvVaw1suiOQ_yxEd8tY1gyKTTki">https://forms.gle/QDUYYAQBrhh1q13A8</a></span></p><p class="c6"><span class="c7">You</span><span class="c5">1:05 PM</span></p><p class="c4"><span class="c3"><a class="c9" href="https://www.google.com/url?q=https://docs.google.com/presentation/d/1-cxHITwVtWJ5x3ev0__XzDtDtJn2cB9CAgN9Mkia3Ag/edit%23slide%3Did.g11de5b0bf6b_0_304&amp;sa=D&amp;source=editors&amp;ust=1647622731275027&amp;usg=AOvVaw3qw1M8H0-XP0MxDrwPXBDW">https://docs.google.com/presentation/d/1-cxHITwVtWJ5x3ev0__XzDtDtJn2cB9CAgN9Mkia3Ag/edit#slide=id.g11de5b0bf6b_0_304</a></span></p><p class="c6"><span class="c7">Hadrien Raffalli</span><span class="c5">1:30 PM</span></p><p class="c4"><span class="c0">sorry mic problems</span></p><p class="c4"><span class="c0">will rejoin</span></p><p class="c6"><span class="c7">Hadrien Raffalli</span><span class="c5">1:37 PM</span></p><p class="c12"><span class="c3"><a class="c9" href="https://www.google.com/url?q=https://support.google.com/ads-help/answer/7367525?hl%3Den&amp;sa=D&amp;source=editors&amp;ust=1647622731275965&amp;usg=AOvVaw3fs6dN8ayT2ULCoNuKDlsv">https://support.google.com/ads-help/answer/7367525?hl=en</a></span></p><p class="c10"><span class="c0"></span></p><p class="c4"><span class="c0">Just to give you an idea of how much A/B testers allow in term of code change size, max container limit on Google Optimize is 400kb</span></p><p class="c6"><span class="c7">Hadrien Raffalli</span><span class="c5">1:39 PM</span></p><p class="c4"><span class="c0">Changes are not just changing css + text, customers might inject javascript for new kinds of interactivity</span></p><p class="c4"><span class="c0">In rare cases, we grant customers container size increases</span></p><p class="c6"><span class="c7">Ankit Jain</span><span class="c5">1:52 PM</span></p><p class="c4"><span class="c0">Hey, I work with VWO (an A/B Testing provider). For creating idempotent operations, and supporting visual changes, full JS would be required.</span></p><p class="c6"><span class="c7">Ankit Jain</span><span class="c5">1:58 PM</span></p><p class="c4"><span class="c0">For Pre-UA, limiting it to specific operations is a good choice. For Post-UA, if we limit it to specific methods, I for-see a lot of custom JS being appended to the head to counter it.</span></p><p class="c6"><span class="c7">Nitish Mittal</span><span class="c5">2:00 PM</span></p><p class="c4"><span class="c0">I also work with VWO, and can help in providing practical usecases which can be helpful</span></p><p class="c6"><span class="c7">Hadrien Raffalli</span><span class="c5">2:02 PM</span></p><p class="c4"><span class="c0">Thanks for inviting me! This was/ is very exciting üëã</span></p><p class="c6"><span class="c7">Neil Craig</span><span class="c5">2:02 PM</span></p><p class="c4"><span class="c0">Avoiding the necessity for CDN would be great,w e use a mixture of commercial CDN and in-house - for cost reasons</span></p><p class="c6"><span class="c7">Ankit Jain</span><span class="c5">2:02 PM</span></p><p class="c4"><span class="c0">+1</span></p><p class="c6"><span class="c7">Tim Kadlec</span><span class="c5">2:02 PM</span></p><p class="c4"><span class="c0">Gotta drop, but super interesting stuff here. Thanks for presenting, Alex.</span></p><p class="c10"><span class="c2"></span></p></div></div><script type="text/javascript" nonce="">(function(){/*

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/
var aa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},ba="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};
function ca(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var da=ca(this);function ea(a,b){if(b)a:{var c=da;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))break a;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ba(c,a,{configurable:!0,writable:!0,value:b})}}var k;
if("function"==typeof Object.setPrototypeOf)k=Object.setPrototypeOf;else{var l;a:{var fa={a:!0},ha={};try{ha.__proto__=fa;l=ha.a;break a}catch(a){}l=!1}k=l?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var ia=k;
function m(a,b){a.prototype=aa(b.prototype);a.prototype.constructor=a;if(ia)ia(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.m=b.prototype}ea("Object.is",function(a){return a?a:function(b,c){return b===c?0!==b||1/b===1/c:b!==b&&c!==c}});
ea("Array.prototype.find",function(a){return a?a:function(b,c){a:{var d=this;d instanceof String&&(d=String(d));for(var e=d.length,f=0;f<e;f++){var g=d[f];if(b.call(c,g,f,d)){b=g;break a}}b=void 0}return b}});var n=this||self;function p(){}function q(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function ja(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();d.push.apply(d,arguments);return a.apply(this,d)}}
function ka(a,b){function c(){}c.prototype=b.prototype;a.m=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.D=function(d,e,f){for(var g=Array(arguments.length-2),h=2;h<arguments.length;h++)g[h-2]=arguments[h];return b.prototype[e].apply(d,g)}}function r(a){return a};function t(a){t[" "](a);return a}t[" "]=p;function la(a,b,c){return Object.prototype.hasOwnProperty.call(a,b)?a[b]:a[b]=c(b)};function ma(a){return la(a.prototype,"$$generatedClassName",function(){return"Class$obf_"+{valueOf:function(){return++na}}})}var na=1E3;function v(){}v.prototype.s=function(){return this.j||(Object.defineProperties(this,{j:{value:oa=oa+1|0,enumerable:!1}}),this.j)};v.prototype.toString=function(){var a=w(x(pa(this.constructor)))+"@";var b=(this.s()>>>0).toString(16);return a+w(b)};function y(){}m(y,v);y.prototype.h=function(a){this.g=a;if(a instanceof Object)try{a.v=this}catch(b){}};function qa(a){a.g instanceof Error&&(Error.captureStackTrace?Error.captureStackTrace(a.g):a.g.stack=Error().stack)}y.prototype.toString=function(){var a=x(pa(this.constructor)),b=this.l;return null==b?a:w(a)+": "+w(b)};
function ra(a){if(null!=a){var b=a.v;if(null!=b)return b}a instanceof TypeError?(b=new sa,b.l=w(a),qa(b),b.i=a,b.h(new TypeError(b)),a=b):(b=new z,b.l=w(a),qa(b),b.i=a,b.h(Error(b)),a=b);return a};function A(){}m(A,y);function B(){}m(B,A);function z(){}m(z,B);z.prototype.h=function(a){B.prototype.h.call(this,"__noinit__"===this.i?a:this.i)};function sa(){}m(sa,z);var oa=0;function ta(a,b){return"string"==typeof a?a.charCodeAt(b):a.g(b)};function C(){}var ua,va;m(C,v);function wa(){wa=function(){};va=new D;ua=new E};function D(){}m(D,C);D.prototype.toString=function(){return""};function E(){}m(E,C);E.prototype.toString=function(){return"unknown"};function w(a){return null==a?"null":a.toString()}function xa(a){return 65536<=a?w(String.fromCharCode((55296+((a-65536|0)>>10&1023)|0)&65535))+w(String.fromCharCode((56320+((a-65536|0)&1023)|0)&65535)):String.fromCharCode(a&65535)}function ya(a,b){var c=b,d=a.length,e;b=ta(a,(e=c,c=c+1|0,e));var f;if(e=55296<=b&&56319>=b&&c<d)a=f=ta(a,c),e=56320<=a&&57343>=a;var g;e?g=65536+((b&1023)<<10)+(f&1023)|0:g=b;return g};function F(a,b){this.g=a;this.h=b}m(F,v);function x(a){if(0!=a.h){var b="L"+w(ma(a.g))+";";a=a.h;for(var c="",d=0;d<a;d=d+1|0)c=w(c)+"[";return w(c)+w(b)}return ma(a.g)}F.prototype.toString=function(){return"class "+w(x(this))};function pa(a){return la(a.prototype,"$$class/0",function(){return new F(a,0)})};function za(a){var b=a;try{var c;if(c="www.google.com"===Aa(a)){var d=Ba(a)[5];c="/url"===G(d,!0)}if(c){var e=Ca(a,"q");b=e?e:Ca(a,"url")}}catch(f){if(f=ra(f),!(f instanceof A))throw f.g;}return null!=b?b:""};function G(a,b){return null==a?a:b?decodeURI(a):decodeURIComponent(a)};var Da;function Ba(a){H();a=Da.exec(a);for(var b=[],c=0;7>=c;c=c+1|0)a.length<=c||null==a[c]?b.push(null):b.push(a[c]);return b}function Aa(a){a=Ba(a);return G(a[3],!0)}
function Ca(a,b){H();var c=a.indexOf(xa(35));c=0>c?a.length:c;a:{var d=0;for(var e=b.length;0<(d=a.indexOf(b,d))&&d<c;){var f=ya(a,d-1|0);if(38==f||63==f){if((d+e|0)>=a.length)break a;f=ya(a,d+e|0);if(61==f||38==f||35==f)break a}d=d+(e+1)|0}d=-1}if(0>d)return null;e=a.indexOf(xa(38),d);if(0>e||e>c)e=c;d=d+(b.length+1)|0;b=Math.min(a.length,d);a=a.substr(b,Math.min(a.length,Math.max(d,e))-b|0);c=" ";for(b=0;0<=(b=c.indexOf("\\",b));)36==c.charCodeAt(b+1|0)?(d=w(c.substr(0,b|0))+"$",e=b=b+1|0,c=d+w(c.substr(e))):
(d=w(c.substr(0,b|0)),e=b=b+1|0,c=d+w(c.substr(e)));a=a.replace(RegExp("\\+","g"),c);return G(a,!1)}function H(){H=function(){};Da=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\S\\s]*))?$")};function Ea(){Ea=function(){};Fa||Ga()};var Ha=/&/g,Ia=/</g,Ja=/>/g,Ka=/"/g,La=/'/g,Ma=/\x00/g,Na=/[\x00&<>"']/;var Oa=null,I;I=null;function J(){var a;if(null==Oa)a:{if(a=n.navigator)if(a=a.userAgent)break a;a=""}else a=Oa;return a}function K(a){return-1!=J().indexOf(a)};function Pa(){var a=I;return!!a&&0<a.brands.length}function Qa(a){a.forEach(function(){})}function Ra(){for(var a=J(),b=RegExp("([A-Z][\\w ]+)/([^\\s]+)\\s*(?:\\((.*?)\\))?","g"),c=[],d;d=b.exec(a);)c.push([d[1],d[2],d[3]||void 0]);Qa(c)}function Ga(){Pa()?I.brands.find(function(a){return"Firefox"===a.brand}):Ra()};var Sa=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if("string"===typeof a)return"string"!==typeof b||1!=b.length?-1:a.indexOf(b,0);for(var c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};var Ta=Pa()?!1:K("Trident")||K("MSIE"),Ua=K("Edge")||Ta,Va=K("Gecko")&&!(-1!=J().toLowerCase().indexOf("webkit")&&!K("Edge"))&&!(K("Trident")||K("MSIE"))&&!K("Edge"),Fa=-1!=J().toLowerCase().indexOf("webkit")&&!K("Edge"),Wa=I,Xa=Wa&&Wa.platform?"macOS"===I.platform:K("Macintosh");function Ya(a){a&&"function"==typeof a.u&&a.u()};function L(){this.h=this.h;this.g=this.g}L.prototype.h=!1;L.prototype.u=function(){this.h||(this.h=!0,this.j())};L.prototype.j=function(){if(this.g)for(;this.g.length;)this.g.shift()()};function Za(a,b,c){for(var d in a)b.call(c,a[d],d,a)};var M;function N(a,b){this.i=a===$a&&b||"";this.j=ab}N.prototype.h=!0;N.prototype.g=function(){return this.i};var ab={},$a={};function O(a,b){this.i=b===P?a:""}O.prototype.h=!0;O.prototype.g=function(){return this.i.toString()};O.prototype.toString=function(){return this.i.toString()};function Q(a){return a instanceof O&&a.constructor===O?a.i:"type_error:SafeUrl"}var bb=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,cb=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function db(a){if(a instanceof O)return a;a="object"==typeof a&&a.h?a.g():String(a);cb.test(a)||(a="about:invalid#zClosurez");return new O(a,P)}
var P={},eb=new O("about:invalid#zClosurez",P);var fb={};function R(a,b,c){this.i=c===fb?a:"";this.h=!0}R.prototype.g=function(){return this.i.toString()};R.prototype.toString=function(){return this.i.toString()};function gb(a,b,c,d){a=a instanceof O?a:db(a);b=b||n;c=c instanceof N?c instanceof N&&c.constructor===N&&c.j===ab?c.i:"type_error:Const":c||"";return void 0!==d?b.open(Q(a),c,d):b.open(Q(a),c)};function S(a,b){this.type=a;this.target=b;this.i=!1}S.prototype.g=function(){this.i=!0};var hb=function(){if(!n.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{n.addEventListener("test",p,b),n.removeEventListener("test",p,b)}catch(c){}return a}();function T(a){S.call(this,a?a.type:"");this.relatedTarget=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.state=null;this.pointerId=0;this.pointerType="";this.h=null;if(a){var b=this.type=a.type,c=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement;var d=a.relatedTarget;if(d){if(Va){a:{try{t(d.nodeName);var e=!0;break a}catch(f){}e=!1}e||(d=null)}}else"mouseover"==
b?d=a.fromElement:"mouseout"==b&&(d=a.toElement);this.relatedTarget=d;c?(this.clientX=void 0!==c.clientX?c.clientX:c.pageX,this.clientY=void 0!==c.clientY?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0);this.button=a.button;this.key=a.key||"";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=
a.metaKey;this.pointerId=a.pointerId||0;this.pointerType="string"===typeof a.pointerType?a.pointerType:ib[a.pointerType]||"";this.state=a.state;this.h=a;a.defaultPrevented&&T.m.g.call(this)}}ka(T,S);var ib={2:"touch",3:"pen",4:"mouse"};T.prototype.g=function(){T.m.g.call(this);var a=this.h;a.preventDefault?a.preventDefault():a.returnValue=!1};var U="closure_listenable_"+(1E6*Math.random()|0);var jb=0;function kb(a,b,c,d,e){this.listener=a;this.proxy=null;this.src=b;this.type=c;this.capture=!!d;this.h=e;this.key=++jb;this.g=this.o=!1}function lb(a){a.g=!0;a.listener=null;a.proxy=null;a.src=null;a.h=null};function V(a){this.src=a;this.g={};this.h=0}V.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.g[f];a||(a=this.g[f]=[],this.h++);var g;a:{for(g=0;g<a.length;++g){var h=a[g];if(!h.g&&h.listener==b&&h.capture==!!d&&h.h==e)break a}g=-1}-1<g?(b=a[g],c||(b.o=!1)):(b=new kb(b,this.src,f,!!d,e),b.o=c,a.push(b));return b};var mb="closure_lm_"+(1E6*Math.random()|0),nb={},ob=0;function pb(a,b,c,d,e){if(d&&d.once)return qb(a,b,c,d,e);if(Array.isArray(b)){for(var f=0;f<b.length;f++)pb(a,b[f],c,d,e);return null}c=rb(c);return a&&a[U]?a.g(b,c,q(d)?!!d.capture:!!d,e):sb(a,b,c,!1,d,e)}
function sb(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=q(e)?!!e.capture:!!e,h=tb(a);h||(a[mb]=h=new V(a));c=h.add(b,c,d,g,f);if(c.proxy)return c;d=ub();c.proxy=d;d.src=a;d.listener=c;if(a.addEventListener)hb||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(vb(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");ob++;return c}
function ub(){function a(c){return b.call(a.src,a.listener,c)}var b=wb;return a}function qb(a,b,c,d,e){if(Array.isArray(b)){for(var f=0;f<b.length;f++)qb(a,b[f],c,d,e);return null}c=rb(c);return a&&a[U]?a.h(b,c,q(d)?!!d.capture:!!d,e):sb(a,b,c,!0,d,e)}
function xb(a){if("number"!==typeof a&&a&&!a.g){var b=a.src;if(b&&b[U])b.i(a);else{var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(vb(c),d):b.addListener&&b.removeListener&&b.removeListener(d);ob--;if(c=tb(b)){d=a.type;if(d in c.g){var e=c.g[d],f=Sa(e,a),g;(g=0<=f)&&Array.prototype.splice.call(e,f,1);g&&(lb(a),0==c.g[d].length&&(delete c.g[d],c.h--))}0==c.h&&(c.src=null,b[mb]=null)}else lb(a)}}}
function vb(a){return a in nb?nb[a]:nb[a]="on"+a}function wb(a,b){if(a.g)a=!0;else{b=new T(b,this);var c=a.listener,d=a.h||a.src;a.o&&xb(a);a=c.call(d,b)}return a}function tb(a){a=a[mb];return a instanceof V?a:null}var yb="__closure_events_fn_"+(1E9*Math.random()>>>0);function rb(a){if("function"===typeof a)return a;a[yb]||(a[yb]=function(b){return a.handleEvent(b)});return a[yb]};function W(a){L.call(this);this.l=a;this.i={}}ka(W,L);var zb=[];function Ab(a){Za(a.i,function(b,c){this.i.hasOwnProperty(c)&&xb(b)},a);a.i={}}W.prototype.j=function(){W.m.j.call(this);Ab(this)};W.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented");};function Bb(a,b,c,d){b=void 0===b?!1:b;c=void 0===c?!1:c;d=void 0===d?"editors":d;L.call(this);this.i=a||document.body;this.s=!!b;this.A=!!c;this.B=d;this.l=new W(this);a=ja(Ya,this.l);this.h?a():(this.g||(this.g=[]),this.g.push(a));a=this.l;b=this.i;c=this.C;d="click";Array.isArray(d)||(d&&(zb[0]=d.toString()),d=zb);for(var e=0;e<d.length;e++){var f=pb(b,d[e],c||a.handleEvent,!1,a.l||a);if(!f)break;a.i[f.key]=f}}m(Bb,L);
Bb.prototype.C=function(a){if(!(0!=a.h.button||Xa&&a.ctrlKey||a.i))for(var b=a.target;b&&b!=this.i;){if(b.tagName&&"a"==b.tagName.toLowerCase()){var c=b.getAttribute("href")||b.getAttributeNS("http://www.w3.org/1999/xlink","href"),d=za(c);if(c!=d){a:{b=void 0;Ea();try{b=Aa(d)}catch(u){u=ra(u);if(u instanceof A){b=!1;break a}throw u.g;}var e;if(e=null!=b){e=(wa(),va);var f=ua;b=Object.is(e,f)||null==e&&null==f?b.toLocaleLowerCase():b.toLowerCase();e=".google.com"===b.substr(b.length-11|0,11)}b=e}if(!b)if(this.A){c=
za(d);if(Object.is(c,d)||null==c&&null==d)d="//www.google.com/url?q="+w(encodeURIComponent(d)),d=w(d)+"&sa=D";d+="&source="+this.B}else d=this.s?c:d;var g=d;b=void 0;c={target:"_blank",noreferrer:!0};d=window;g instanceof O?e=g:(e="undefined"!=typeof g.href?g.href:String(g),e instanceof O||(e="object"==typeof e&&e.h?e.g():String(e),cb.test(e)?e=new O(e,P):(e=String(e),e=e.replace(/(%0A|%0D)/g,""),e=e.match(bb)?new O(e,P):null)),e=e||eb);var h=void 0!==self.crossOriginIsolated;f="strict-origin-when-cross-origin";
window.Request&&(f=(new Request("/")).referrerPolicy);var Db="unsafe-url"===f;f=c.noreferrer;if(h&&f){if(Db)throw Error("Cannot use the noreferrer option on a page that sets a referrer-policy of `unsafe-url` in modern browsers!");f=!1}g=c.target||g.target;h=[];for(b in c)switch(b){case "width":case "height":case "top":case "left":h.push(b+"="+c[b]);break;case "target":case "noopener":case "noreferrer":break;default:h.push(b+"="+(c[b]?1:0))}b=h.join(",");if((K("iPhone")&&!K("iPod")&&!K("iPad")||K("iPad")||
K("iPod"))&&d.navigator&&d.navigator.standalone&&g&&"_self"!=g)c="A",b=document,c=String(c),"application/xhtml+xml"===b.contentType&&(c=c.toLowerCase()),b=c=b.createElement(c),e=e instanceof O?e:db(e),b.href=Q(e),c.setAttribute("target",g),f&&c.setAttribute("rel","noreferrer"),b=document.createEvent("MouseEvent"),b.initMouseEvent("click",!0,!0,d,1),c.dispatchEvent(b);else if(f){if(d=gb("",d,g,b),c=Q(e),d){Ua&&-1!=c.indexOf(";")&&(c="'"+c.replace(/'/g,"%27")+"'");d.opener=null;""===c&&(c="javascript:''");
Na.test(c)&&(-1!=c.indexOf("&")&&(c=c.replace(Ha,"&amp;")),-1!=c.indexOf("<")&&(c=c.replace(Ia,"&lt;")),-1!=c.indexOf(">")&&(c=c.replace(Ja,"&gt;")),-1!=c.indexOf('"')&&(c=c.replace(Ka,"&quot;")),-1!=c.indexOf("'")&&(c=c.replace(La,"&#39;")),-1!=c.indexOf("\x00")&&(c=c.replace(Ma,"&#0;")));c='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+c+'">';if(void 0===M)if(b=null,(e=n.trustedTypes)&&e.createPolicy){try{b=e.createPolicy("goog#html",{createHTML:r,createScript:r,
createScriptURL:r})}catch(u){n.console&&n.console.error(u.message)}M=b}else M=b;c=(b=M)?b.createHTML(c):c;c=new R(c,null,fb);(d=d.document)&&d.write&&(d.write(c instanceof R&&c.constructor===R?c.i:"type_error:SafeHtml"),d.close())}}else(d=gb(e,d,g,b))&&c.noopener&&(d.opener=null);a.g();break}}b=b.parentNode}};function Cb(a,b,c,d){new Bb(a,void 0===b?!1:b,void 0===c?!1:c,d)}var X=["DOCS_installLinkReferrerSanitizer"],Y=n;X[0]in Y||"undefined"==typeof Y.execScript||Y.execScript("var "+X[0]);
for(var Z;X.length&&(Z=X.shift());)X.length||void 0===Cb?Y[Z]&&Y[Z]!==Object.prototype[Z]?Y=Y[Z]:Y=Y[Z]={}:Y[Z]=Cb;}).call(this);
</script><script type="text/javascript" nonce="">DOCS_installLinkReferrerSanitizer( undefined,  true,  true, 'docs');</script></body></html>